
<!doctype html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> 	
<html lang="en"> 
<!--<![endif]-->
  <head>
    <meta charset="utf-8" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />	<!-- Force Latest IE rendering engine -->
    <title>A few thoughts on testing from the trench part2</title>

    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->


    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href="http://feeds2.feedburner.com/tu0huang" rel="alternate" title="Tuo" type="application/atom+xml" /> 
    <link rel="shortcut icon" href="/static/images/favicon.png" />

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 

    <link rel="stylesheet" href="/static/css/style.css">

    <!--[if IE 7]>
      <script src="/static/css/font-awesome-ie7.css"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">	
      <div id='mobile' class='two columns hidden'>
        <ul>
          <li><a href='/'>tuohuang</a></li>
          <li><span class="gray">Tuo Huang 黄拓</span></li>
          <li><a href="mailto:clarkhtse@gmail.com.com">clarkhtse@gmail.com.com</a></li>
          <li><a href="http://twitter.com/tu0huang">@tu0huang</a></li>
        </ul>
      </div>

      <div class="four columns sidebar">
        <section>
          <a id="avatar" href="/"></a>

          <ul id="social">
            <li>
              <a href="mailto:clarkhtse@gmail.com?subject=hi" class="icon-envelope-alt" title="Say hi"></a>
            </li>

            <li>
              <a href="http://twitter.com/tu0huang" class="icon-twitter" title="You should follow me" style="font-size: 28px;"></a>
            </li>

            <li>
              <a href="http://github.com/tuo" class="icon-github"  title="I share and fork code here"></a>
            </li>
            <li>
              <a href="http://feeds2.feedburner.com/tu0huang" class="icon-rss" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Sidebar RSS']);" title="RSS"></a>
            </li>
          </ul>

          <ul id="me">
            <li>Tuo Huang 黄拓</span><a href="http://weibo.com/tu0huang" style="display:inline-block;"><img src='/static/images/sinaweibo.png'/></a></li>
            <li class="gray">iOS and Android developer.</li>
          </ul>

        </section>
      </div>

      <article class='ten columns offset-by-four' id="article-content">
  <header class="ten columns" id="article-header">
    <h1>A few thoughts on testing from the trench part2</h1>
  </header>

  <div class='ten columns gray' id="date-header">
    <p>
      Sep 11, 2010
  
    </p>

  </div>

  <div class="ten columns" id="article-content">
    &nbsp;&nbsp;&nbsp;&nbsp;In my last blog ”<a href="http://tuohuang.thoughtworkers.org/?p=28" target="_blank">A few thoughts on testing from the trench</a>“ , i have described a  scenario i  gotta stumbled in . The situation  is  that i forgot to add cleanup method to former testcase   ,which sets the tone for some intricate failures of newly added testcases.Way too nitty-gritty,let's ,say, put simply ,i just broke the prerequisites or presumptions  that later test case relies on due to my carelessness. And i just come up with a solution,which just adds the cleanup to former testcases , as illustrated in following code :
<pre class="brush: csharp; ">[Test]
public void should_return_configed_timeframe_when_timeframe_in_app_setting_is_in_right_format()
{
 ConfigurationManager.AppSettings.Set(DateTimeHelper.TRIGGER_TIMEFRAME_KEY, "17:00:00");
 actualReturned = DateTimeHelper.ReadTimeframeFromConfig();
 expectedReturn = CreateUtcDateTimeByHHMM(17, 0);
 Assert.AreEqual(DateTimeKind.Utc, actualReturned.Kind);
 Assert.AreEqual(expectedReturn, actualReturned);

 ConfigurationManager.AppSettings.Set(DateTimeHelper.TRIGGER_TIMEFRAME_KEY, null);
 var configedTime = ConfigurationManager.AppSettings.Get(DateTimeHelper.TRIGGER_TIMEFRAME_KEY);
 Assert.IsNull(configedTime);
}</pre>
&nbsp;&nbsp;&nbsp;&nbsp;Code between line 10 and  13 is what i thought of as a ,ah ,not bad remedy at that time. Well, it turns out that i just add more woods to "evil" fire. How can i say to myself? Man , What a miserable guy!  So when<a href="http://www.iamhukai.com/" target="_blank"> Kai Ge</a> reviews my codes  ,a quick glance at those testcases , as u probably know ,the following conversation definitely blow my mind. He said ,"hey,why not put those cleanup code to TearDown() method derived from NUnit? " I said"Ah,ah,ah....." and i just gotta stuck ,period .  With a astonishingly fast follow-up question ,he said,"What if any exception thrown out from your test code before your cleanup? So u just leave the testcase's "Crime Scene" ,again, uncleaned? "  So that question just blows my mind with a big "Wow" from bottom of my heart.  Yes ,definitely,i just write the codes without too much mediation.

&nbsp;&nbsp;&nbsp;&nbsp;But what really reveals is that it shows that how unfamiliar i am with  the framework i use. So did i even know the architecture or the design philosophy behind its surface ?  No , i just use it blindly and shitly , without resorting to any documentations or any tips for using that framework.  Lack of specific or ,how to say ,background or backbone of tools u use may significantly slow u down and encumber your productivity dramatically.

&nbsp;&nbsp;&nbsp;&nbsp;Well ,it reminds me that <a href="http://www.iamhukai.com/" target="_blank">Kai Ge</a> has already talked about JUnit's design,well ,a little long ago , and i may have certain sorts of impression on that , admittedly, at that time ,not so impressive enough to let me get big "WOW"  at the time i write testcases in the first place. So, i just forget it when i coded it plainly. It seems that i need to practice more to get that kinda of familiarity.

&nbsp;&nbsp;&nbsp;&nbsp;I also remember that i just see a fabulous article about how JUnit gotta be shaped by using patterns by Kent Beck. Although JUnit is simple for seasoned engineer like Kai Ge ,for me --a rookie , 'Ma Que Sui Xiao ,Wu Zang Ju Quan!(Read this in PinYin拼音) ,i think i have that kinda of need to learn .   This article<span style="color: #33ff33;"> <a href="http://junit.sourceforge.net/doc/cookstour/cookstour.htm" target="_blank">J</a></span><a href="http://junit.sourceforge.net/doc/cookstour/cookstour.htm" target="_blank"><span style="color: #cc0000;">U</span>nit A Cook's Tour</a> suits my appetite.Likewise, there is a big chapter about realizing a mini test framework like JUnit in Perl  step by step  in  Kent Beck 's book &lt;&lt;<a href="http://www.amazon.com/Test-Driven-Development-Kent-Beck/dp/0321146530" target="_blank">Test Driven Development: By Example</a> &gt;&gt;.

&nbsp;&nbsp;&nbsp;&nbsp;In <span style="color: #33ff33;"><a href="http://junit.sourceforge.net/doc/cookstour/cookstour.htm" target="_blank">J</a></span><a href="http://junit.sourceforge.net/doc/cookstour/cookstour.htm" target="_blank"><span style="color: #cc0000;">U</span>nit A Cook's Tour</a> Kent Beck and Erich Gamma(who is also a big cow大牛)  mainly emphasize on how patterns come together to shape the whole design ,like Composite Pattern ,Template Pattern  and so on. Here is a figure i referred from this article ,  talking about how Template Pattern gotta applied  to     <span>TestCase.run() --the core method in JUnit.</span>

<span> <img class="alignnone" title="TestCase.run() applies Template Method" src="http://junit.sourceforge.net/doc/cookstour/Image2.gif" alt="" width="270" height="142" /></span>

&nbsp;&nbsp;&nbsp;&nbsp;<span> Here comes the code  quoted from that article: </span>
<pre class="brush: java; ">public void run(){
setUp();
try {
runTest();
}
catch (AssertionFailedError e) { //1

//collection test result

}
finally {
tearDown();
}

}</pre>
&nbsp;&nbsp;&nbsp;&nbsp;This is pretty straightforward .So we know that TearDown() is put into finally block in case that when any exception thrown from runTest() method or not ,the tearDown() method is always kept committed that it will be executed.  After we grasped nitty-gritty ,we ,now,are completely confident how to handle cleanup because we know how it works behind the scene.

&nbsp;&nbsp;&nbsp;&nbsp;The final solution is that we move those cleanup method to TearDown() method , so that we 're always promised the "Crime Scene" is gonna be cleaned and no messy.

&nbsp;&nbsp;&nbsp;&nbsp;So ,truth is that we need to keep informed about the tools that we use ,to some extent. Spending a little time  on it ,we're probably gonna be more productive and less prone to get stumbled.

&nbsp;&nbsp;&nbsp;&nbsp;And thanks for patience and tips from <a href="http://www.iamhukai.com/" target="_blank">Kai Ge</a> ,i really appreciate it.

  </div>
  <hr style="visibility:hidden;"/>
  
  <!--<footer class="ten columns">
    <p id='follow'>
       Follow me on <a href="http://twitter.com/tu0huang">Twitter</a> &
       <a href="http://weibo.com/tu0huang">Weibo</a>	   
    </p>
  </footer> -->
</article>

<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ten columns offset-by-four" style="margin-bottom: 11px;">
	<a class="addthis_counter addthis_pill_style"></a>
</div>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50f9651243f1723a"></script>
<!-- AddThis Button END -->
<div style="margin-bottom:10px;"/>
<div id="disqus_thread" class="ten columns offset-by-four"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'tuohuang'; // required: replace example with your forum shortname
  var disqus_identifier = '/tuohuangid';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
  </body>
</html> 
