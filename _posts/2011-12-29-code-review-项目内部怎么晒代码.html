--- 
layout: post
title: "Code Review-\xE9\xA1\xB9\xE7\x9B\xAE\xE5\x86\x85\xE9\x83\xA8\xE6\x80\x8E\xE4\xB9\x88\xE6\x99\x92\xE4\xBB\xA3\xE7\xA0\x81"
tags: []

status: draft
type: post
published: false
meta: 
  _edit_last: "1"
---
前阵子为了保证项目中代码的质量, 便每天早上搞起了code review: 大家围做在电视机前,然后连上笔记本,用textmate打开昨天大家提交的代码(git diff), 大家一起就着代码开始讲这段代码是干嘛干嘛的blabla. 但是整个流程却也不是非常专业,很多地方大家都没注意到,于是系统了解下code review和项目改进后的code review流程便有了此文.
 什么是Code Review?
 我的理解,也是结合项目中的实践便是它是项目中的大部分开发者(最好是全部)每天抽出一定时间对昨天或今天提交的代码修改"晒"出来,大家一起浏览这些代码,找出自己不清楚的或者提出改进的地方.
 Code Review的优点
  晒代码的好处在于: 首先,降低truck number,  它提供一种方式能让所有的开发者在同一个上下文中,能让他们了解代码的变化,降低truck number; 其次,知识分享,团队内部学习, 它提供了一中知识分享的渠道, 有经验的人可以通过解释比如为什么这段代码这么写,这个模块为什么是这么划分的来帮助新手们更快的学习和提高; 再者, 发现问题和提--即使有结对编程,但是人总是有思维盲点和局限,这个时候那么多人看你的代码, 可以帮助你发现问题来提高代码质量和保持代码风格的统一(忘记checkstyle).
 什么不是Code Review?
    1.代码超过1000行?
      当然这个阈值很难掌握,仅供参考,比如一次整个移动文件夹就会有非常多的diff--这个可以排除.
    2.review的间隔超过一个星期
      一般情况下,当项目已经启动之后的一两个星期可能代码提交没有多少,适当的拉长code review间隔是可以接受,但是最好有一个上限,比如一个星期.但是到了三四个星期之后,项目开始进入开发状态,可能需要缩短时间,比如我们项目便是一天一次.有时候提交不多,可能便是两天一次.
    3. 花费超过10-20分钟准备环境
       这个在我们项目中一般来说,用git来到最新的提交,并取到昨天一天的code diff,并用textmate打开,这个准备时间一般来说不会超过五分钟.
    4. 花费超过一个小时在review过程中
       
    3.只有Peer Review
      Code Review的关键在于让所有开发者都参与,当然不一定是全部,但是尽量是.Peer Review指的是将自己写的代码发给同事来检视,也许是通过email这种方式, 也许是通过一些高级工具,比如Code Collaborator.但是这个局限在一两个同事之间并不能很好的实现代码质量的提高和知识的分享.
    4.每次代码提交之前做
       一种意见在于当你写代码完毕准备提交到远程的代码库之前做code review, 这样也就是所谓的持续代码检视.这个下想法可能是好的,但是实践起来很困难, 因为在敏捷中提倡的另外一件事便是频繁提交,那如果每隔5分钟有人提交,是不是每次都得把人叫齐做了? 很明显不太实际.所以他们使用了peer review,每次提交之前把要提交代码发给一两个同事看,如果ok,便提交,但是它就不是完整意义上的code review.

  
 
