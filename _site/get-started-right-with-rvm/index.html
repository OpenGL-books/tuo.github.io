
<!doctype html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> 	
<html lang="en"> 
<!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />	<!-- Force Latest IE rendering engine -->
    <title>Get started right with RVM</title>

    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->


    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href="http://feeds.feedburner.com/sirupsen" rel="alternate" title="Sirupsen" type="application/atom+xml" /> 
    <link rel="shortcut icon" href="/static/images/favicon.png" />

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 

    <link rel="stylesheet" href="/static/css/style.css">

    <!--[if IE 7]>
      <script src="/static/css/font-awesome-ie7.css"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">	
      <div id='mobile' class='two columns hidden'>
        <ul>
          <li><a href='/'>Sirupsen</a></li>
          <li><span class="gray">Simon Hørup Eskildsen</span></li>
          <li><a href="mailto:sirup@sirupsen.com" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Mobile', 'Sidebar Email']);">sirup@sirupsen.com</a></li>
          <li><a href="http://twitter.com/Sirupsen" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Mobile', Sidebar Email']);">@Sirupsen</a></li>
        </ul>
      </div>

      <div class="four columns sidebar">
        <section>
          <a id="avatar" href="/"></a>

          <ul id="social">
            <li>
              <a href="mailto:sirup@sirupsen.com?subject=hi" class="icon-envelope-alt" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Sidebar Email']);" title="Say hi"></a>
            </li>

            <li>
              <a href="http://twitter.com/Sirupsen" class="icon-twitter" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Sidebar Twitter']);" title="You should follow me" style="font-size: 28px;"></a>
            </li>

            <li>
              <a href="http://github.com/Sirupsen" class="icon-github" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Sidebar Github']);" title="I share and fork code here"></a>
            </li>

            <li>
              <a href="skype:sirupsen?add" class="icon-comment" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Sidebar Skype']);" title="Feel free to add me on Skype"></a>
            </li>

            <li>
              <a href="http://feeds.feedburner.com/sirupsen" class="icon-rss" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Sidebar RSS']);" title="RSS"></a>
            </li>
          </ul>

          <ul id="me">
            <li>Simon Hørup Eskildsen</span></li>
            <li class="gray">Ruby developer.</li>
          </ul>

        </section>
      </div>

      <article class='ten columns offset-by-four' id="article-content">
  <header class="ten columns" id="article-header">
    <h1>Get started right with RVM</h1>
  </header>

  <div class='ten columns gray' id="date-header">
    <p>
      Sep 2010
  
      revised Nov 2012
  
    </p>

  </div>

  <div class="ten columns" id="article-content">
    <p>I’ve always run Ruby with <a href="http://rvm.beginrescueend.com/">RVM</a>. After
<a href="http://twitter.com/chopmo">@chopmo’s</a> talk at <a href="http://aarhusrb.dk">Aarhusrb</a> on
RVM, I realized how much more I could get out of RVM. I found I basically use
RVM as just a way to switch between Ruby versions and implementations, rather
than leveraging the power of gemsets, installing gems on a user basis and the
<code>.rvmrc</code> file. This post is a compiled version of what I learned from the
previously mentioned talk and digging into the <a href="http://rvm.beginrescueend.com/">RVM documentation</a>.</p>

<h2 id="installing-rvm">Installing RVM</h2>

<p>If you haven’t already, install RVM at the user level:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>bash &lt; &lt;<span class="o">(</span> curl http://rvm.beginrescueend.com/releases/rvm-install-head <span class="o">)</span>
</code></pre>
</div>

<p>With &gt; 1 RVM users on the system, you may want to look into a system-wide
<a href="http://rvm.beginrescueend.com/deployment/system-wide/">system-wide installation</a>.
Otherwise, it is recommended to stay with the default user-wide installation.</p>

<p>To inject RVM into your environment <code>.bashrc</code>, <code>.bash_profile</code>, add the bit of
bash it mentions at the end of the installation:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">&#39;[[ -s &quot;$HOME/.rvm/scripts/rvm&quot; ]] &amp;&amp; source &quot;$HOME/.rvm/scripts/rvm&quot;&#39;</span> &gt;&gt; .bashrc
</code></pre>
</div>

<h3 id="fixing-slow-gem-installations">Fixing slow gem installations</h3>

<p>Installing Ruby gems is by default a slow affair due to <code>ri</code> and <code>rdoc</code>
documentation generation. Most likely you do not use this, and can disable it in
return for vastly improved installation speeds:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">gem</span><span class="p">:</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">ri</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">rdoc</span>
</code></pre>
</div>

<p>Verify whether the <code>rvm</code> command works and check system specific notes:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm notes
</code></pre>
</div>

<h2 id="uninstalling-all-gems-in-system-ruby-optional">Uninstalling all gems in system Ruby (Optional)</h2>

<p>This step can safely be skipped, I simply performed it to clean my system.</p>

<p>With RVM installed, you can simply empty your current, global gemset (this’ll
make more sense in a minute):</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm gemset empty
</code></pre>
</div>

<p>You can easily take a backup of all your installed Gem’s and their versions with
RVM:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm gemset <span class="nb">export </span>backup.gems
</code></pre>
</div>

<p>If you want to restore, it’s simply a matter of running:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm gemset import backup.gems
</code></pre>
</div>

<p>I’ll mention why <code>rvm gemset {import,export}</code> is as nifty as it is further down.</p>

<h2 id="installing-rubies">Installing Rubies</h2>

<p>In RVM jargon Rubies are essentially Ruby versions, let’s go ahead and install
<code>Ruby MRI 1.9.3</code> (this is the default interpreter originally developed by Matz)
first, and set that as our default interpreter. Afterwards, we’ll install <code>Ruby
1.8.7</code>, use RVM to easily switch between these two Rubies.</p>

<p>Installing <code>1.9.3</code> is the trivial matter of issuing:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm install 1.9.3
</code></pre>
</div>

<p>This can take a while, since it compiles from source. When this process has
finished, switch to it with the following command to verify it works:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm 1.9.3 <span class="c"># shortcut for rvm use 1.9.3</span>
<span class="nv">$ </span>ruby -v
ruby 1.9.3p194 <span class="o">(</span>2012-04-20 revision 35410<span class="o">)</span> <span class="o">[</span>x86_64-darwin11.4.0<span class="o">]</span>
</code></pre>
</div>

<p>By default, your default interpreter is the system Ruby provided by your
operating system, for instance in OS X this is <code>MRI Ruby 1.8.7</code>. You want to set
this to a Ruby maintained by RVM to make use of all RVM’s features:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm --default 1.9.3
</code></pre>
</div>

<p>Restart your shell, and run <code>ruby -v</code> to verify it is not the default Ruby.
Let’s install <code>1.8.7</code> along with <code>1.9.3</code>:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm install 1.8.7
</code></pre>
</div>

<p>We can then switch to it just as before:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm 1.8.7
</code></pre>
</div>

<p>You are now up and running with two Rubies! With RVM, you can also install
different interpreters such as Rubinius, JRuby or Maglev following the
same installation procedure as above.</p>

<h2 id="gemsets">Gemsets</h2>

<h3 id="what">What?</h3>

<p>The shortest explanation, is found within the name. Gem-sets.<br />
RVM’s documentation puts it like this:</p>

<blockquote>
  <p>RVM gives you compartmentalized independent ruby setups. This means that ruby,
gems and irb are all separate and self-contained from system and from each
other.   You may even have separate named gemsets.  Let’s say, for example,
that you are testing two versions of a gem with ruby 1.9.3-head. You can
install one to the default 1.9.3-head and create a named gemset for the other
version and switch between them easily.</p>
</blockquote>

<p>Ideally you have a Gemset for each project that you are working on. This keeps
your system clean, and eliminates “Gem clutter” and version mismatches. Also
running <code>bundle install</code> will use the project defined gemset to also store the
gems.</p>

<h3 id="contemporary-note-on-gem-versions-and-gemsets">Contemporary note on gem versions and gemsets</h3>

<p>When I wrote this article, <code>bundler</code> wasn’t commonly found in Ruby projects as
it is now. <code>bundler</code> now solves the problems gemsets solved, by ensuring the
correct versions of the gems for the specific projects are loaded into the
environment by running scripts in your project with <code>bundler exec</code> rather than
<code>ruby</code>. <code>bundler</code> projects thus make simpler approaches to the problem RVM solves
possible, the most popular alternative nowadays is
<a href="https://github.com/sstephenson/rbenv">rbenv</a> which I use on most of my systems
these days.</p>

<h3 id="creating-and-using-a-gemset">Creating and using a gemset</h3>

<p>Let’s go ahead and create a gemset:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm gemset create foo <span class="c"># Create gemset &#39;foo&#39;</span>
<span class="s1">&#39;foo&#39;</span> gemset created <span class="o">(</span>/home/sirup/.rvm/gems/ruby-1.9.3-p0@foo<span class="o">)</span>.

<span class="nv">$ </span>rvm 1.9.3@foo <span class="c"># Switch to Ruby 1.9.3 with gemset &#39;foo&#39;</span>
<span class="nv">$ </span>gem list <span class="c"># Lists installed gems</span>
*** LOCAL GEMS ***
</code></pre>
</div>

<p>We’ll go ahead and install a few gems in our new gemset, note that we are not
using <code>sudo</code> to install gems, as the gemsets are stored in your user directory,
and thus does not require administrator privileges: </p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>gem install rails
<span class="nv">$ </span>gem list
gem list
*** LOCAL GEMS ***

abstract <span class="o">(</span>1.0.0<span class="o">)</span>
actionmailer <span class="o">(</span>3.0.0<span class="o">)</span>
actionpack <span class="o">(</span>3.0.0<span class="o">)</span>
activemodel <span class="o">(</span>3.0.0<span class="o">)</span>
<span class="o">[</span>..<span class="o">]</span>
</code></pre>
</div>

<p>Switching back to our default, global gemset, will reveal that <code>rails</code> and its
associated gems above, was indeed installed in an isolated gemset.</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm 1.9.3 <span class="c"># explicit: rvm 1.9.3@global</span>
<span class="nv">$ </span>gem list
</code></pre>
</div>

<p>As expected, <code>gem list</code> returns an empty list since there are no gems in the
global gemset which we cleared earlier.</p>

<h3 id="dumping-and-loading-gemsets">Dumping and loading gemsets</h3>

<p>Exporting a gemset is easy with RVM as previously mentioned:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm 1.9.3@foo
<span class="nv">$ </span>rvm gemset <span class="nb">export </span>rails.gems
<span class="nv">$ </span>cat rails.gems
abstract -v1.0.0
actionmailer -v3.0.0
actionpack -v3.0.0
activemodel -v3.0.0
<span class="o">[</span>..<span class="o">]</span>
</code></pre>
</div>

<p>You can then toss <code>rails.gems</code> to someone else, who’d be able to import that
gemset as follows:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm use 1.9.3@rails --create <span class="c"># shortcut to create, then switch to it</span>
<span class="nv">$ </span>rvm gemset import rails.gems
</code></pre>
</div>

<p>Installing all the gems from <code>rails.gems</code> with the right versions. This works
great in teams, because of all the version conflicts that otherwise happen if
you just install the newest versions of everything.</p>

<h3 id="contemporary-note-on-exporting-and-importing-gemsets">Contemporary note on exporting and importing gemsets</h3>

<p>Nowadays we have <code>bundler</code> which also solves this problem, which used to be a
massive pain. Nonetheless, it still has a wide array of usages today.</p>

<h3 id="the-global-and-default-gemset">The global and default gemset</h3>

<p>Two interesting gemsets are the <code>global</code> (<code>~/.rvm/gemsets/global.gems</code>) and
<code>default</code> (<code>~/.rvm/gemsets/default.gems</code>) gemsets.  </p>

<p>Gems in the <code>global gemset</code>, will be added to the global gemset in <em>every</em> new
Ruby you install. <code>rake</code>, <code>rdoc</code> and <code>bundler</code> are good examples of handy global
gems. The gems in the <code>default gemset</code> are the gems included in every newly
created gemset.</p>

<h2 id="rvmrc">rvmrc</h2>

<p>There are three different kinds of <code>rvmrc</code> files:</p>

<ul>
  <li>System <code>/etc/rvmrc</code>
    <ul>
      <li>System wide configuration</li>
    </ul>
  </li>
  <li>User <code>~/.rvmrc</code>
    <ul>
      <li>User wide configuration</li>
    </ul>
  </li>
  <li>Project <code>.rvmrc</code>
    <ul>
      <li>Project wide configuration</li>
    </ul>
  </li>
</ul>

<p>The most interesting one is the project <code>.rvmrc</code>. Every time you <code>cd</code>, RVM looks
for a file called <code>.rvmrc</code>. If it finds it, it executes it. The following
<code>.rvmrc</code> file would switch to <code>Ruby MRI 1.8.7</code> and gemset <code>project</code> every time
we change into that directory:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;rvm 1.8.7@project&quot;</span> &gt; ~/projects/ruby-1.8.7-project/.rvmrc
</code></pre>
</div>

<p>I received <a href="http://twitter.com/wayneeseguin/status/24387445101">a tip</a> from
RVM’s creator <a href="http://twitter.com/wayneeseguin">@wayneeseguin</a>, that we can be
even more sneaky about this:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm --create --rvmrc 1.8.7@project
</code></pre>
</div>

<p>This will create the gemset, and the <code>.rvmrc</code> file for the project all in one
command!</p>

<p>To demonstrate what we just did:</p>

<div class="highlight"><pre><code class="bash">~/projects <span class="nv">$ </span>ruby -v
ruby 1.9.3p194 <span class="o">(</span>2012-04-20 revision 35410<span class="o">)</span> <span class="o">[</span>x86_64-darwin11.4.0<span class="o">]</span>
~/projects <span class="nv">$ </span><span class="nb">cd </span>ruby-1.8.7-project/
~/projects/ruby-1.8.7-project <span class="nv">$ </span>ruby -v
ruby 1.8.7 <span class="o">(</span>2012-02-08 patchlevel 358<span class="o">)</span> <span class="o">[</span>universal-darwin12.0<span class="o">]</span>
~/projects/ruby-1.8.7-project <span class="nv">$ </span>rvm gemset name
project
</code></pre>
</div>

<p>My favorite configuration option is <code>rvm_gemset_create_on_use_flag=1</code>, having
this line in <code>/etc/rvmrc</code> or <code>~/.rvmrc</code>, gemsets will be automatically created
if they do not exist when you switch to them:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>rvm gemset list
gemsets <span class="k">for </span>ruby-1.9.3-p194 <span class="o">(</span>found in /home/sirup/.rvm/gems/ruby-1.9.3-p0<span class="o">)</span>
gemsets <span class="k">for </span>ruby-1.8.7-p358 <span class="o">(</span>found in /home/sirup/.rvm/gems/ruby-1.9.3-p358<span class="o">)</span>

foo
global
<span class="nv">$ </span>rvm gemset use foobar
Now using gemset <span class="s1">&#39;foobar&#39;</span>
</code></pre>
</div>

<p><a href="http://twitter.com/wayneeseguin">@wayneeseguin</a> sent in <a href="http://twitter.com/wayneeseguin/status/24387379953">another tip</a> about how to add <a href="http://rvm.beginrescueend.com/workflow/completion/"><code>bash</code> and <code>zsh</code> completion</a>. </p>

<p>You can read more about <code>rvmrc</code> in <a href="http://rvm.beginrescueend.com/workflow/rvmrc/">RVM’s documentation</a>.</p>

<h2 id="conclusion">Conclusion</h2>

<p>This is all briefly describing what can be found in <a href="http://rvm.beginrescueend.com/">RVM’s (fantastic)
documentation</a>. For basic use, this article
should cover the main topics, however, RVM can still do a whole lot more than I
addressed here. The goal of this post was simply to get you started well, and
right, with RVM.</p>

<p><a href="http://news.ycombinator.com/item?id=1686435">Discuss this on Hacker News</a></p>

  </div>

  <footer class="ten columns">
    <p id='follow'>
      You should follow me on Twitter <a href="http://twitter.com/Sirupsen" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Post Twitter']);">here.</a>
    </p>
  </footer>
</article>

    </div>

    <script> var _gaq=[["_setAccount","UA-9939782-5"],["_trackPageview"]]; (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1; g.src=("https:"==location.protocol?"//ssl":"//www")+".google-analytics.com/ga.js"; s.parentNode.insertBefore(g,s)}(document,"script")); </script>
  </body>
</html> 
